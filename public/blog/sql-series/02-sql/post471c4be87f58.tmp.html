<div id="making-a-database-on-amazon" class="section level2" number="0.1">
<h2 number="0.1"><span class="header-section-number">0.1</span> Making a database on Amazon</h2>
<p><strong>Step 1:</strong> Create an AWS account. I did it a long time ago, it’s pretty straightforward, I’m not going to re-do it here for no reason.</p>
<p><strong>Step 2:</strong> Follow Items 1-5 only in <a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_Tutorials.WebServerDB.CreateDBInstance.html">this tutorial</a> to create a databaset instance.</p>
<p><strong>Step 3:</strong> Make sure you choose the free tier! Select whatever username and password you want - but it’s a pain in the butt to add additional users, so if security is not a huge concern and you want your database to be broadly accessible, choose a username and password that you’re willing to share.</p>
<p><img src="aws_rds-2.png" /></p>
<p><strong>Step 4:</strong> Make sure you switch the “Public Access” button to <em>Yes</em>. Again, this is assuming you’re using databases because your data is large, not because you have major security needs.</p>
<p><img src="aws_rds-3.png" /></p>
<p>(People still need to know the username and password to access the database, even if it is set to Public.)</p>
<p><strong>Step 5:</strong> Click this thing:</p>
<p><img src="aws_rds-4.png" /></p>
<p>Then choose an initial database name:</p>
<p><img src="aws_rds-5.png" /></p>
<p><strong>WARNING! ACHTUNG! ATTENTION!</strong></p>
<p>For the love of all that is good, don’t skip this step. For some reason it isn’t in most of the tutorials I found online.</p>
<p>If you don’t choose a database name, you create only a “database instance,” which is like an empty shell where a database should be.</p>
<p><em>Why is the default behavior to create an empty shell?</em> No idea.</p>
<p><em>Can we just add a database to a database instance after creating it?</em> Undoubtedly, but I can’t be arsed to learn that. The goal here is to stay in my safe R bubble. I sunk about an hour into trying to figure that out, unsuccessfully, before deleting my database instance and making a new one.</p>
<p><strong>Step 5:</strong> Scroll to the bottom and click “Create Database.” You should see something like this:</p>
<p><img src="aws_rds-6.png" /></p>
<p>Be patient while Amazon obeys your command and makes your database. Click the name of your database instance (<code>vineyard-project</code> for me). You’ll see this - notice how the banner says it’s still being created, and the “Status” in the Summary pane says “Creating.”</p>
<p><img src="aws_rds-7.png" /></p>
<p>When it’s done, it will look like this:</p>
<p><img src="aws_rds-9.png" /></p>
<p><strong>Step 6:</strong> Gather your info.</p>
<p>You will need:</p>
<ul>
<li><p>Your username and password</p></li>
<li><p>The name of the database that you chose in Step 5</p></li>
<li><p>Your <em>Endpoint</em> (or “host”) and your <em>Port</em>, which can be found here:</p></li>
</ul>
<p><img src="aws_rds-8.png" /></p>
<div id="connecting-from-r" class="section level3" number="0.1.1">
<h3 number="0.1.1"><span class="header-section-number">0.1.1</span> Connecting from R</h3>
<p>Okay so the first thing you have to do is install and load a bunch libraries that help R talk to SQL.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dbplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(odbc)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DBI)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RMySQL)</span></code></pre></div>
<p><code>dbplyr</code> is the one that lets you use <code>dplyr</code> R code to sneakily run SQL queries.</p>
<p>The rest of them are just “some packages I need for SQL” and I haven’t bothered to understand what tasks each one covers, or even which of the functions I’m about to use come from which package. Sorry not sorry.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(RMySQL<span class="sc">::</span><span class="fu">MySQL</span>(), </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">user=</span><span class="st">&#39;&lt;YOUR USERNAME&gt;&#39;</span>, </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">password=</span><span class="st">&#39;&lt;YOUR PASSWORD&gt;&#39;</span>, </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">dbname=</span><span class="st">&#39;&lt;YOUR DATABASE&gt;&#39;</span>,    <span class="co"># this is &quot;vineyard-project&quot; for me</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">host=</span><span class="st">&#39;&lt;YOUR HOST&gt;&#39;</span>,          <span class="co"># you found the host and port   </span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">port=</span><span class="st">&#39;&lt;YOUR PORT NUMBER&gt;&#39;</span>)   <span class="do">## in step 6 above </span></span></code></pre></div>
<p>You can write data to your brand new SQL server like this:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbWriteTable</span>(con, <span class="st">&quot;data_counts_orig&quot;</span>, data_counts)</span></code></pre></div>
<p>This might take a long time, depending on how big your data is.</p>
<p>If your data isn’t already in R, or if it’s too big to read into R, I suggest using a third-party helper app.</p>
<p>Stay tuned for Part 2, where we will learn to pull sbusetted SQL data back into R using <code>dbplyr</code>!</p>
</div>
</div>
